/*! Built with http://stenciljs.com */
const{h:e}=window.StencilStateTunnel;var t=function(t,s=function(t,s){return e("context-consumer",{subscribe:t,renderer:s})}){let i=new Map,n=t;function r(e,t){Array.isArray(e)?[...e].forEach(e=>{t[e]=n[e]}):t[e]=Object.assign({},n),t.forceUpdate()}function a(e){return t=>{i.has(t)||(i.set(t,e),r(e,t))}}function o(e,t){return a(t)(e),function(){i.delete(e)}}return{Provider:function({state:e,children:t}){return n=e,i.forEach(r),t},Consumer:function({children:e}){return s(o,e[0])},wrapConsumer:function(t,s){const i=t.is;return t=>{var{children:n}=t,r=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(s[i[n]]=e[i[n]])}return s}(t,["children"]);return e(i,Object.assign({ref:a(s)},r),n)}},injectProps:function(e,t){let s=null;const i=Object.keys(e.properties).find(t=>1==e.properties[t].elementRef);if(void 0==i)throw new Error(`Please ensure that your Component ${e.is} has an attribtue with "@Element" decorator. `+"This is required to be able to inject properties.");const n=e.prototype.componentWillLoad;e.prototype.componentWillLoad=function(){if(s=o(this[i],t),n)return n.bind(this)()};const r=e.prototype.componentDidUnload;e.prototype.componentDidUnload=function(){if(s(),r)return r.bind(this)()}}}}({messageLog:[],sendMessage:()=>Promise.resolve(),getReceiverList:()=>Promise.resolve([]),availableReceivers:[],creatingMessage:!1,setCreatingMessage:()=>{}},(t,s)=>e("context-consumer",{subscribe:t,renderer:s}));var s=function(e,t,s,i){return new(s||(s=Promise))(function(n,r){function a(e){try{c(i.next(e))}catch(e){r(e)}}function o(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):new s(function(t){t(e.value)}).then(a,o)}c((i=i.apply(e,t||[])).next())})};class i{constructor(){this.availableReceivers=[],this.messageLog=[],this.creatingMessage=!1,this.sendMessage=((e,t)=>s(this,void 0,void 0,function*(){const s=yield function(e,t){return Promise.resolve({id:(1e17*Math.random()).toString().match(/.{4}/g).join("-"),timeStamp:new Date,message:e,recipients:t})}(e,t);this.messageLog=[...this.messageLog,s]})),this.getReceiverList=(()=>s(this,void 0,void 0,function*(){return this.availableReceivers.length>0?this.availableReceivers:this.availableReceivers=yield Promise.resolve([{id:"1",name:"George Washington"},{id:"2",name:"John Adams"},{id:"3",name:"Thomas Jefferson"},{id:"4",name:"James Madison"},{id:"5",name:"James Monroe"},{id:"6",name:"John Quincy Adams"}])})),this.setCreatingMessage=(e=>{this.creatingMessage=e})}render(){const s={messageLog:this.messageLog,sendMessage:this.sendMessage,getReceiverList:this.getReceiverList,availableReceivers:this.availableReceivers,creatingMessage:this.creatingMessage,setCreatingMessage:this.setCreatingMessage};return e(t.Provider,{state:s},e("header",null,this.creatingMessage?null:e("button",{onClick:()=>{this.creatingMessage=!0}},"Create Message"),e("h1",null,"Message Demo App")),this.creatingMessage?e("demo-create-message",{sendMessage:this.sendMessage}):e("demo-message-log",null))}static get is(){return"demo-app"}static get properties(){return{availableReceivers:{state:!0},creatingMessage:{state:!0},messageLog:{state:!0}}}static get style(){return"demo-app{display:block;width:700px;margin:0 auto}"}}var n=function(e,t,s,i){return new(s||(s=Promise))(function(n,r){function a(e){try{c(i.next(e))}catch(e){r(e)}}function o(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){e.done?n(e.value):new s(function(t){t(e.value)}).then(a,o)}c((i=i.apply(e,t||[])).next())})};class r{constructor(){this.availableRecipients=[],this.selectedReceiverIds=[],this.sendToMessageQueue=(e=>{if(e.preventDefault(),this.errorText=null,0===this.selectedReceiverIds.length)return void(this.errorText="A message must have at least one receiver.");if(""===this.input.value)return void(this.errorText="Message cannot be empty");const t=this.availableRecipients.filter(e=>-1!==this.selectedReceiverIds.indexOf(e.id));this.sendMessage(this.input.value,t),this.setCreatingMessage(!1)}),this.updateRecipientList=(()=>{this.selectedReceiverIds=Array.from(this.select.querySelectorAll("option")).filter(e=>e.selected).map(e=>e.value)}),this.cancelMessage=(e=>{e.preventDefault(),this.setCreatingMessage(!1)})}componentWillLoad(){return n(this,void 0,void 0,function*(){this.availableRecipients=yield this.getReceiverList()})}render(){return e("form",{onSubmit:this.sendToMessageQueue},null!=this.errorText?e("p",{class:"error"},this.errorText):null,e("label",null,"Recipients:",e("select",{multiple:!0,ref:e=>this.select=e,onChange:this.updateRecipientList},this.availableRecipients.map(t=>e("option",{value:t.id},t.name)))),e("br",null),e("label",null,"Message Text:",e("input",{ref:e=>this.input=e,type:"text"})),e("div",null,e("input",{type:"submit",value:"Send message"}),e("a",{href:"#",onClick:this.cancelMessage},"Cancel")))}static get is(){return"demo-create-message"}static get properties(){return{availableRecipients:{state:!0},el:{elementRef:!0},errorText:{state:!0},getReceiverList:{type:"Any",attr:"get-receiver-list"},sendMessage:{type:"Any",attr:"send-message"},setCreatingMessage:{type:"Any",attr:"set-creating-message"}}}static get style(){return".error{color:red}"}}t.injectProps(r,["sendMessage","getReceiverList","creatingMessage","setCreatingMessage"]);class a{render(){return e(t.Consumer,null,({messageLog:t})=>e("div",null,0===t.length?e("p",null,"No messages sent."):e("ul",{class:"msg-list"},t.sort((e,t)=>t.timeStamp.getTime()-e.timeStamp.getTime()).map(t=>e("li",{key:t.id},e("span",{class:"row-desc"},"To:")," ",t.recipients.map(e=>e.name).join(", "),e("br",null),e("span",{class:"row-desc"},"Time:")," ",function(e){const t=e.getHours(),s=e.getMinutes(),i=e.getSeconds();return`${[0===t?"12":t>12?t-12:t,s<10?`0${s}`:s,i<10?`0${i}`:i].join(":")} ${t>12?"pm":"am"}`}(t.timeStamp),e("br",null),e("span",{class:"row-desc"},"Text:")," ",t.message,e("br",null))))))}static get is(){return"demo-message-log"}static get style(){return"ul.msg-list{list-style:none;padding-left:10px}ul.msg-list li{padding:10px 0}.row-desc{display:inline-block;font-weight:700;width:45px}"}}export{i as DemoApp,r as DemoCreateMessage,a as DemoMessageLog};